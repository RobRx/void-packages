# Template file for 'gst-plugins-good1'
pkgname=gst-plugins-good1
version=1.26.7
revision=1
build_style=meson
build_helper="qmake qmake6"
qmake_default_version=none
configure_args="-Ddv=disabled -Ddv1394=disabled -Dshout2=disabled -Dqt5=enabled
 -Dqt6=enabled $(vopt_feature wayland qt-wayland) -Dqt-method=qmake
 $(vopt_feature gtk3 gtk3) -Dpkgconfig.relocatable=true"
hostmakedepends="pkg-config gettext glib-devel orc qt5-qmake
 qt5-host-tools qt6-base qt6-shadertools"
makedepends="libpng-devel libgudev-devel libflac-devel orc-devel
 $(vopt_if x11 'libXdamage-devel libXv-devel qt5-x11extras')
 gst-plugins-base1-devel $(vopt_if pulseaudio pulseaudio-devel) v4l-utils-devel
 $(vopt_if jack jack-devel) libvpx-devel lame-devel mpg123-devel qt5-devel
 qt5-declarative-devel $(vopt_if wayland 'qt5-wayland-devel qt6-wayland-devel')
 $(vopt_if gtk3 gtk+3-devel) qt6-base-private-devel qt6-declarative-devel"
depends="gst-plugins-base1>=${version}"
short_desc="GStreamer set of well-maintained good plug-ins (1.x)"
maintainer="Orphaned <orphan@voidlinux.org>"
license="LGPL-2.1-or-later"
homepage="https://gstreamer.freedesktop.org"
changelog="https://gstreamer.freedesktop.org/releases/${version%.*}/#${version}"
distfiles="https://gstreamer.freedesktop.org/src/gst-plugins-good/gst-plugins-good-${version}.tar.xz"
checksum=82af18a1f3e4a060db61d2630fbb975269b80b55bb2fdcfddfab5c6440d30781

build_options="gtk3 x11 wayland pulseaudio jack"
build_options_default="gtk3 x11 wayland pulseaudio"

do_check() {
	ninja -C build test || : #Fails on i686
}

gst-plugins-good1-qt5_package() {
	short_desc+=" - Qt5 plugins"
	depends="gst-plugins-good1-${version}_${revision}"
	pkg_install() {
		vmove usr/lib/gstreamer-1.0/libgstqmlgl.so
	}
}

gst-plugins-good1-qml6_package() {
	short_desc+=" - Qt6 Qml plugin"
	depends="gst-plugins-good1-${version}_${revision}"
	pkg_install() {
		vmove usr/lib/gstreamer-1.0/libgstqml6.so
	}
}
