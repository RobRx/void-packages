# Template file for 'gst-plugins-bad1'
pkgname=gst-plugins-bad1
version=1.26.3
revision=1
build_helper="gir"
build_style=meson
configure_args="-Dpackage-origin=https://voidlinux.org -Ddoc=disabled
 -Dopencv=disabled -Dmsdk=disabled -Dopensles=disabled
 -Dtinyalsa=disabled -Dwasapi=disabled -Ddc1394=disabled
 -Diqa=disabled -Dlibde265=disabled -Dmpeg2enc=disabled
 -Dmplex=disabled -Dmusepack=disabled -Dopenexr=disabled
 -Dopenh264=disabled -Dopenmpt=disabled -Dopenni2=disabled -Dsctp=disabled
 -Dsrt=disabled -Dteletext=disabled -Dvoaacenc=disabled -Dvoamrwbenc=disabled
 -Dwildmidi=disabled -Dwpe=disabled -Ddirectfb=disabled
 $(vopt_feature gir introspection) -Dneon=disabled"
hostmakedepends="gettext pkg-config python3 glib-devel orc
 $(vopt_if wayland wayland-devel)"
makedepends="alsa-lib-devel openssl-devel gst-plugins-base1-devel orc-devel
 libexif-devel libmpcdec-devel librsvg-devel libcurl-devel libass-devel
 opus-devel libwebp-devel $(vopt_if wayland wayland-devel) x265-devel
 libnice-devel libbluetooth-devel libgudev-devel libusb-devel
 libaom-devel libbs2b-devel fdk-aac-devel lilv-devel lv2 libopenjpeg2-devel
 vulkan-loader-devel webrtc-audio-processing-devel libva-devel"
depends="gst-plugins-base1>=${version}"
short_desc="GStreamer plugins from the bad set (v1.x)"
maintainer="Orphaned <orphan@voidlinux.org>"
license="GPL-2.0-or-later, LGPL-2.1-or-later"
homepage="https://gstreamer.freedesktop.org"
changelog="https://gstreamer.freedesktop.org/releases/${version%.*}/#${version}"
distfiles="https://gstreamer.freedesktop.org/src/gst-plugins-bad/gst-plugins-bad-${version}.tar.xz"
checksum=95c48dacaf14276f4e595f4cbca94b3cfebfc22285e765e2aa56d0a7275d7561

build_options="gir wayland"
build_options_default="gir wayland"

if [ -z "$CROSS_BUILD" ] && [ "$XBPS_CHECK_PKGS" ]; then
	configure_args+=" -Dtests=enabled"
else
	configure_args+=" -Dtests=disabled"
fi

do_check() {
	ninja check || msg_warn "Tests failed, but not unexpected\n"
}

gst-plugins-bad1-devel_package() {
	depends="gst-plugins-base1-devel>=${version} ${sourcepkg}>=${version}_${revision}"
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/include
		vmove usr/lib/pkgconfig
		vmove usr/lib/*.so
		if [ "$build_option_gir" ]; then
			vmove "usr/share/gir*"
		fi
	}
}
